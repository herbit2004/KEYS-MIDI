<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>虚拟MIDI键盘</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <!-- 引入Tone.js库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script>
        // 设置Tone.js的延迟提示以优化交互响应
        Tone.context.latencyHint = "interactive";
    </script>
</head>
<body>
    <div class="midi-keyboard">
        <!-- 顶部控制区域 -->
        <div class="top-panel">
            <div class="logo-section">
                <h1>KEYS-MIDI</h1>
            </div>
            
            <!-- 帮助按钮和主显示屏容器 -->
            <div class="display-container">
                <!-- 帮助按钮 -->
                <button id="help-button" class="help-button">
                    <span class="help-icon">?</span>
                </button>
                <!-- 主显示屏 -->
                <div class="main-display">
                    <div class="display-content">PATCH-01</div>
                </div>
            </div>
            
            <!-- 帮助窗口 -->
            <div id="help-modal" class="help-modal">
                <div class="help-modal-content">
                    <span class="close-button">&times;</span>
                    <div class="help-panel" id="help-panel">
            <h3>🎹 KEYS-MIDI 使用说明</h3>
            
            <div class="help-section">
                <h4>🎵 键盘演奏</h4>
                <div class="help-content">
                    <h5>键盘映射模式</h5>
                    <ul>
                        <li><strong>默认映射</strong>：使用 <kbd>tab</kbd> <kbd>1</kbd> <kbd>q</kbd> <kbd>2</kbd> <kbd>w</kbd> <kbd>e</kbd> <kbd>4</kbd> <kbd>r</kbd> <kbd>5</kbd> <kbd>t</kbd> <kbd>6</kbd> <kbd>y</kbd> <kbd>u</kbd> <kbd>8</kbd> <kbd>i</kbd> <kbd>9</kbd> <kbd>o</kbd> <kbd>p</kbd> <kbd>-</kbd> <kbd>[</kbd> <kbd>=</kbd> <kbd>]</kbd> <kbd>backspace</kbd> <kbd>\</kbd> <kbd>z</kbd> <kbd>s</kbd> <kbd>x</kbd> <kbd>d</kbd> <kbd>c</kbd> <kbd>v</kbd> <kbd>g</kbd> <kbd>b</kbd> <kbd>h</kbd> <kbd>n</kbd> <kbd>j</kbd> <kbd>m</kbd> <kbd>,</kbd> <kbd>l</kbd> <kbd>.</kbd> <kbd>;</kbd> <kbd>/</kbd> 等键演奏</li>
                        <li><strong>替代映射</strong>：使用 <kbd>z</kbd> <kbd>s</kbd> <kbd>x</kbd> <kbd>d</kbd> <kbd>c</kbd> <kbd>v</kbd> <kbd>g</kbd> <kbd>b</kbd> <kbd>h</kbd> <kbd>n</kbd> <kbd>j</kbd> <kbd>m</kbd> <kbd>,</kbd> <kbd>l</kbd> <kbd>.</kbd> <kbd>;</kbd> <kbd>/</kbd> <kbd>tab</kbd> <kbd>1</kbd> <kbd>q</kbd> <kbd>2</kbd> <kbd>w</kbd> <kbd>e</kbd> <kbd>3</kbd> <kbd>r</kbd> <kbd>4</kbd> <kbd>t</kbd> <kbd>5</kbd> <kbd>y</kbd> <kbd>u</kbd> <kbd>6</kbd> <kbd>i</kbd> <kbd>7</kbd> <kbd>o</kbd> <kbd>8</kbd> <kbd>p</kbd> <kbd>[</kbd> <kbd>=</kbd> <kbd>]</kbd> <kbd>\</kbd> <kbd>backspace</kbd> 等键演奏</li>
                    </ul>
                    <h5>演奏技巧</h5>
                    <ul>
                        <li>支持多键同时按下演奏和弦</li>
                        <li>按住<kbd>空格键</kbd>作为延音踏板，实现音符延长效果</li>
                        <li>支持鼠标点击虚拟键盘演奏</li>
                        <li>可通过映射选择按钮切换键盘布局</li>
                    </ul>
                </div>
            </div>
            
            <div class="help-section">
                <h4>🎛️ 转调控制</h4>
                <div class="help-content">
                    <h5>快捷键转调</h5>
                    <ul>
                        <li><kbd>↑</kbd> 升高八度 | <kbd>↓</kbd> 降低八度</li>
                        <li><kbd>←</kbd> 升高半音 | <kbd>→</kbd> 降低半音</li>
                    </ul>
                    <h5>界面控制</h5>
                    <ul>
                        <li>通过界面中的<kbd>+</kbd>/<kbd>-</kbd>按钮调整八度和半音转调</li>
                        <li>使用<kbd>RESET</kbd>按钮重置所有转调设置</li>
                        <li>转调范围：八度 ±3，半音 ±12</li>
                    </ul>
                </div>
            </div>
            
            <div class="help-section">
                <h4>🎼 音色系统</h4>
                <div class="help-content">
                    <h5>音色类型</h5>
                    <ul>
                        <li><strong>合成音色</strong>：钢琴、吉他、贝斯等合成器音色</li>
                        <li><strong>采样音色</strong>：真实乐器采样（钢琴、吉他、打击乐）</li>
                        <li><strong>打击乐</strong>：47个GM标准打击乐音色</li>
                    </ul>
                    <h5>音色选择</h5>
                    <ul>
                        <li>通过顶部<kbd>TONE</kbd>下拉菜单切换音色</li>
                        <li>☁ 图标表示采样音色尚未加载</li>
                        <li>采样音色首次选择时会自动加载</li>
                        <li>加载过程中会显示进度通知</li>
                    </ul>
                    <h5>打击乐映射</h5>
                    <ul>
                        <li>音高范围：B1-A5（47个打击乐音色）</li>
                        <li>B1-C2：底鼓、军鼓、镲片等基础打击乐</li>
                        <li>C3-D3：通鼓、叮叮镲等中音打击乐</li>
                        <li>E4-A5：邦戈鼓、康加鼓、三角铁等拉丁打击乐</li>
                        <li>按对应音高的键位触发不同打击乐音色</li>
                    </ul>
                </div>
            </div>
            
            <div class="help-section">
                <h4>🎚️ 音频效果</h4>
                <div class="help-content">
                    <h5>全局效果器</h5>
                    <ul>
                        <li><strong>延迟</strong>：调整延迟时间和反馈量</li>
                        <li><strong>混响</strong>：调整混响衰减和强度</li>
                        <li><strong>主音量</strong>：控制整体音量输出</li>
                    </ul>
                    <h5>操作方式</h5>
                    <ul>
                        <li>点击旋钮选中后，滚动鼠标滚轮调整参数</li>
                        <li>实时调节，立即生效</li>
                        <li>每个音色可独立配置效果器链</li>
                    </ul>
                </div>
            </div>
            
            <div class="help-section">
                <h4>🎹 MIDI编辑器</h4>
                <div class="help-content">
                    <h5>录制播放</h5>
                    <ul>
                        <li>点击<kbd>录制</kbd>按钮开始录制演奏</li>
                        <li>点击<kbd>播放</kbd>按钮回放录制内容</li>
                        <li>点击<kbd>停止</kbd>按钮停止播放或录制</li>
                        <li>点击<kbd>暂停</kbd>按钮暂停播放</li>
                    </ul>
                    <h5>文件操作</h5>
                    <ul>
                        <li>点击<kbd>保存</kbd>按钮导出JSON格式工程文件（包含BPM和拍/小节信息）</li>
                        <li>点击<kbd>导入</kbd>按钮加载JSON工程文件</li>
                        <li>点击<kbd>导出</kbd>按钮导出标准MIDI文件</li>
                        <li>点击<kbd>全屏</kbd>按钮进入/退出全屏编辑模式</li>
                    </ul>
                    <h5>音符编辑</h5>
                    <ul>
                        <li>在画布上点击音符可选中，可框选多个音符</li>
                        <li>拖拽选中音符可移动位置或调整长度</li>
                        <li>使用<kbd>Ctrl+C</kbd>/<kbd>Ctrl+X</kbd>/<kbd>Ctrl+V</kbd>复制/剪切/粘贴音符</li>
                        <li>选中音符后使用方向键微调位置</li>
                        <li>按<kbd>Delete</kbd>键删除选中音符</li>
                        <li>选中音符后在音符上滚动鼠标滚轮可调整音符力度</li>
                        <li>点击<kbd>鼠标输入</kbd>按钮启用鼠标创建音符模式</li>
                    </ul>
                    <h5>撤回/恢复功能</h5>
                    <ul>
                        <li>使用<kbd>Ctrl+Z</kbd>撤回上一步操作</li>
                        <li>使用<kbd>Ctrl+Y</kbd>恢复被撤回的操作</li>
                        <li>最多支持10次连续撤回/恢复</li>
                        <li>支持撤回：音符编辑、删除、移动、复制粘贴、录制、力度调节等</li>
                        <li>撤回操作会自动释放选中的音符</li>
                        <li>空录制（无音符输入）不会记录历史</li>
                        <li>连续的力度调节会被合并为一个历史记录</li>
                    </ul>
                    <h5>视图控制</h5>
                    <ul>
                        <li>按住<kbd>Ctrl</kbd>滚动滚轮可缩放时间轴</li>
                        <li>按住<kbd>Ctrl+Shift</kbd>滚动滚轮可调整画布高度</li>
                        <li>在空白区域拖拽可框选多个音符</li>
                        <li>点击播放头可改变播放位置</li>
                    </ul>
                    <h5>播放设置</h5>
                    <ul>
                        <li>通过BPM输入框调整播放速度（20-300 BPM）</li>
                        <li>通过拍/小节输入框调整每小节拍数（0-10拍）</li>
                        <li>通过节拍器开关控制节拍器启停</li>
                        <li>通过自动吸附开关控制音符吸附到网格</li>
                        <li>支持调整节拍器音量（-60dB到0dB）</li>
                        <li>支持调整吸附灵敏度（0-50%）和吸附精度（1/1到1/10）</li>
                        <li>支持一键吸附触发和一键吸附时长功能</li>
                    </ul>
                    <h5>音色管理</h5>
                    <ul>
                        <li>左侧音色显示控制面板可切换音色可见性</li>
                        <li>鼠标悬浮音色按钮显示音色名称工具提示</li>
                        <li>悬浮音色时对应音符会高亮显示</li>
                        <li>支持多音色轨道同时编辑</li>
                    </ul>
                    <h5>鼠标静态输入</h5>
                    <ul>
                        <li>点击<kbd>鼠标输入</kbd>按钮启用鼠标创建音符模式</li>
                        <li>在编辑器中点击创建音符，拖拽调整音符时长</li>
                        <li>支持实时音频反馈，创建音符时播放对应音色</li>
                        <li>自动分配到当前选择的音色轨道</li>
                        <li>支持撤回/恢复操作</li>
                    </ul>
                </div>
            </div>
            
            <div class="help-section">
                <h4>⌨️ 快捷键总览</h4>
                <div class="help-content">
                    <h5>编辑操作</h5>
                    <ul>
                        <li><kbd>Ctrl+Z</kbd> 撤回操作</li>
                        <li><kbd>Ctrl+Y</kbd> 恢复操作</li>
                        <li><kbd>Ctrl+C</kbd> 复制音符</li>
                        <li><kbd>Ctrl+X</kbd> 剪切音符</li>
                        <li><kbd>Ctrl+V</kbd> 粘贴音符</li>
                        <li><kbd>Delete</kbd> 删除音符</li>
                    </ul>
                    <h5>转调控制</h5>
                    <ul>
                        <li><kbd>↑</kbd> 升高八度</li>
                        <li><kbd>↓</kbd> 降低八度</li>
                        <li><kbd>←</kbd> 降低半音</li>
                        <li><kbd>→</kbd> 升高半音</li>
                        <li><kbd>空格</kbd> 延音踏板</li>
                    </ul>
                    <h5>音符编辑</h5>
                    <ul>
                        <li><kbd>方向键</kbd> 微调音符位置</li>
                        <li><kbd>鼠标滚轮</kbd> 调节音符力度</li>
                        <li><kbd>拖拽</kbd> 移动音符或调整时长</li>
                    </ul>
                </div>
            </div>
            
            <div class="help-section">
                <h4>📊 状态栏信息</h4>
                <div class="help-content">
                    <h5>信息显示</h5>
                    <ul>
                        <li><strong>左侧</strong>：播放头位置和音轨总长（显示时间、拍数、小节数）</li>
                        <li><strong>右侧</strong>：鼠标位置信息或选中音符信息</li>
                        <li>无选中音符时显示鼠标位置和音高</li>
                        <li>有选中音符时显示音符详细信息（包含音色信息）</li>
                    </ul>
                    <h5>时间格式</h5>
                    <ul>
                        <li>时间显示格式：Xs (X beats, 第X小节)</li>
                        <li>支持秒数、拍数、小节数三种时间单位</li>
                        <li>小节数根据当前拍/小节设置自动计算</li>
                    </ul>
                </div>
            </div>
            
            <div class="help-section">
                <h4>⚡ 高级功能</h4>
                <div class="help-content">
                    <h5>懒加载机制</h5>
                    <ul>
                        <li>采样音色采用懒加载，首次选择时自动下载</li>
                        <li>加载过程中显示进度通知</li>
                        <li>已加载的音色会缓存，无需重复下载</li>
                        <li>提升应用启动速度，节省带宽</li>
                    </ul>
                    <h5>音色平衡</h5>
                    <ul>
                        <li>每个音色都有预设音量，确保听感平衡</li>
                        <li>合成音色和采样音色音量已优化</li>
                        <li>打击乐音色音量适合节奏演奏</li>
                    </ul>
                    <h5>性能优化</h5>
                    <ul>
                        <li>使用Web Audio API实现低延迟音频处理</li>
                        <li>Tone.js提供专业级音频合成</li>
                        <li>支持多键同时按下，无冲突</li>
                        <li>实时音频效果处理</li>
                        <li>响应式设计，适配不同屏幕尺寸</li>
                    </ul>
                    <h5>工程文件管理</h5>
                    <ul>
                        <li>支持JSON格式工程文件导入导出</li>
                        <li>保存完整的轨道信息、BPM、拍/小节设置</li>
                        <li>向后兼容，支持旧版本文件格式</li>
                        <li>自动恢复音色配置和播放设置</li>
                    </ul>
                    <h5>MIDI导出功能</h5>
                    <ul>
                        <li>支持导出标准MIDI文件格式</li>
                        <li>包含多轨道音色信息和音符数据</li>
                        <li>保留完整的节拍、速度、力度信息</li>
                        <li>可在其他音乐软件中打开和编辑</li>
                        <li>支持音色映射和通道分配</li>
                    </ul>
                </div>
            </div>
            
            <div class="help-section">
                <h4>❓ 常见问题</h4>
                <div class="help-content">
                    <h5>音频问题</h5>
                    <ul>
                        <li><strong>听不到声音</strong>：检查浏览器是否允许音频播放，确保音量设置正确</li>
                        <li><strong>键盘映射不工作</strong>：确保焦点在页面上，尝试点击页面任意位置</li>
                        <li><strong>录制功能不工作</strong>：确保选择了正确的音色，检查浏览器权限设置</li>
                    </ul>
                    <h5>编辑问题</h5>
                    <ul>
                        <li><strong>撤回功能不工作</strong>：确保进行了编辑操作，检查是否超出历史记录限制</li>
                        <li><strong>音符无法选中</strong>：确保在正确的编辑模式下，尝试刷新页面</li>
                        <li><strong>吸附功能异常</strong>：检查吸附开关是否开启，调整吸附精度设置</li>
                    </ul>
                    <h5>文件问题</h5>
                    <ul>
                        <li><strong>无法保存文件</strong>：检查浏览器下载设置，确保有足够存储空间</li>
                        <li><strong>导入文件失败</strong>：确保文件格式正确，检查文件是否损坏</li>
                        <li><strong>MIDI导出问题</strong>：确保有音符数据，检查轨道设置</li>
                    </ul>
                </div>
            </div>
        </div>
                </div>
            </div>
        </div>
        

        
        <!-- 键盘控制区域 -->
        
        <!-- MIDI编辑器区域 -->
        <div class="midi-editor-container">
            <div class="midi-editor-controls">
                <!-- 播放控制按钮组 -->
                <div class="control-group">
                    <button id="record-button-editor" class="midi-editor-button">
                        <img src="icons/record.svg" alt="录制">
                    </button>
                    <button id="stop-button-editor" class="midi-editor-button" style="display: none;">
                        <img src="icons/stop.svg" alt="停止">
                    </button>
                    <button id="play-button-editor" class="midi-editor-button">
                        <img src="icons/play.svg" alt="播放">
                    </button>
                    <button id="pause-button-editor" class="midi-editor-button" style="display: none;">
                        <img src="icons/pause.svg" alt="暂停">
                    </button>
                </div>
                
                <!-- 合并的控制组：包含BPM、拍/小节、节拍器、自动吸附和文件操作 -->
                <div class="control-group">
                    <!-- BPM 输入框 -->
                    <div class="bpm-control">
                        <label for="bpm-input">BPM:</label>
                        <input type="number" id="bpm-input" class="bpm-input" min="20" max="300" value="120">
                    </div>
                    <!-- 每小节拍数输入框 -->
                    <div class="beats-per-measure-control">
                        <label for="beats-per-measure-input">拍/小节:</label>
                        <input type="number" id="beats-per-measure-input" class="beats-per-measure-input" min="0" max="10" value="4">
                    </div>
                    <!-- 节拍器开关 -->
                    <div class="metronome-control">
                        <button class="midi-editor-button metronome-snap-button">
                            <img src="icons/metronome.svg" alt="节拍器" id="metronome-icon" class="control-icon">
                        </button>
                        <!-- 节拍器音量控制栏 -->
                        <div class="control-slider-container" id="metronome-volume-container" style="display: none;">
                            <div class="slider-description">节拍器音量</div>
                            <div class="slider-value" id="metronome-volume-value">-25 dB</div>
                            <input type="range" id="metronome-volume" class="control-slider" min="-60" max="0" value="-25" step="1">
                        </div>
                    </div>
                    <!-- 自动吸附开关 -->
                    <div class="snap-control">
                        <button class="midi-editor-button metronome-snap-button">
                            <img src="icons/snap.svg" alt="自动吸附" id="snap-icon" class="control-icon">
                        </button>
                        <!-- 自动吸附灵敏度控制栏 -->
                        <div class="control-slider-container" id="snap-sensitivity-container" style="display: none;">
                            <div class="slider-description">吸附灵敏度</div>
                            <div class="slider-value" id="snap-sensitivity-value">15</div>
                            <input type="range" id="snap-sensitivity" class="control-slider" min="0" max="50" value="15" step="1">
                            <!-- 新增吸附精度选择 -->
                            <div class="snap-precision-control">
                                <div class="slider-description">吸附精度</div>
                                <div class="slider-value" id="snap-precision-value">1/1</div>
                                <input type="range" id="snap-precision" class="control-slider" min="1" max="10" value="1" step="1">
                            </div>
                            <!-- 一键吸附触发按钮 -->
                            <button id="snap-all-button" class="midi-editor-button dropdown-menu-button">一键吸附触发</button>
                            <!-- 一键吸附时长按钮 -->
                            <button id="snap-duration-button" class="midi-editor-button dropdown-menu-button">一键吸附时长</button>
                        </div>
                    </div>
                    <!-- 鼠标输入按钮 -->
                    <div class="mouse-input-control">
                        <button id="mouse-input-button" class="midi-editor-button metronome-snap-button">
                            <img src="icons/mouse.svg" alt="鼠标输入" class="control-icon">
                        </button>
                    </div>
                    
                    <!-- 导出控制 -->
                    <div class="export-control">
                        <button id="save-button-editor" class="midi-editor-button metronome-snap-button">
                            <img src="icons/export.svg" alt="保存" class="control-icon">
                        </button>
                        <!-- 导出选项菜单 -->
                        <div class="control-slider-container" id="export-options-container" style="display: none; opacity: 0; transition: opacity 0.2s;">
                            <div class="slider-description">导出格式</div>
                            <button id="export-json-button" class="midi-editor-button dropdown-menu-button">导出JSON</button>
                            <button id="export-midi-button" class="midi-editor-button dropdown-menu-button">导出MIDI</button>
                        </div>
                    </div>
                    <!-- 导入按钮 -->
                    <button id="load-button-editor" class="midi-editor-button metronome-snap-button">
                        <img src="icons/import.svg" alt="导入" class="control-icon">
                    </button>
                </div>
                
                <!-- 全屏按钮 -->
                <button id="fullscreen-button" class="midi-editor-button fullscreen-button">
                    <img src="icons/fullscreen.svg" alt="全屏">
                </button>
                
                <!-- 预加载fullscreen-exit.svg用于JavaScript切换 -->
                <img src="icons/fullscreen-exit.svg" alt="" style="display: none;">
                <input type="file" id="load-file-input" accept=".json" style="display: none;">
            </div>
            <div class="midi-editor-wrapper">
                <div class="midi-editor-track">
                    <div class="canvas-container">
                        <canvas id="midi-editor"></canvas>
                        <div class="midi-editor-playhead" id="playhead"></div>
                    </div>
                </div>
            </div>
            <!-- MIDI编辑器信息显示区域 -->
            <div class="midi-editor-info">
                <div class="playhead-info">播放头位置: <span id="playhead-position">0.00</span>s / <span id="track-duration">0.00</span>s</div>
                <div class="selected-notes-info" id="selected-notes-info">
                    <!-- 选中音符信息将在这里显示 -->
                </div>
            </div>
        </div>
        
        <!-- 键盘区域 -->
        <div class="keyboard-container">
            <!-- 映射选择功能 -->
            <div class="mapping-selector">
                <!-- 音色选择器 -->
                <div class="tone-selector">
                    <select id="tone-select" class="tone-select">
                        <!-- 音色选项将由JavaScript动态生成 -->
                    </select>
                    <div class="knob-label">TONE</div>
                </div>
                
                <!-- 八度控制 -->
                <div class="octave-controls">
                    <button id="octave-down" class="octave-button">-</button>
                    <div class="octave-display">OCT<span id="octave-shift">0</span></div>
                    <button id="octave-up" class="octave-button">+</button>
                </div>
                
                <!-- 转调控制 -->
                <div class="transpose-controls">
                    <button id="transpose-down" class="transpose-button">-</button>
                    <div class="transpose-display">TR<span id="key-turning">0</span></div>
                    <button id="transpose-up" class="transpose-button">+</button>
                </div>
                
                <!-- 重置按钮 -->
                <button id="reset" class="reset-button">RESET</button>
                <!-- 释放按钮 -->
                <button id="release" class="reset-button release-button">RELEASE</button>
                
                <!-- 映射选择 -->
                <div class="choice-chips">
                    <input type="radio" id="default-mapping" name="key-mapping" value="default" checked>
                    <label for="default-mapping" class="chip">映射一</label>
                    
                    <input type="radio" id="alternative-mapping" name="key-mapping" value="alternative">
                    <label for="alternative-mapping" class="chip">映射二</label>
                </div>
            </div>
            <canvas id="keyboard" width="880" height="200"></canvas>
        </div>
        
        <!-- 全局效果器控制区 -->
        <div class="control-panel">
            <div class="control-section">
                <div class="knobs-row">
                    <div class="knob-item" data-param="delay-time" data-min="0.1" data-max="1" data-step="0.1" data-value="0.2">
                        <div class="knob-container">
                            <div class="knob"></div>
                        </div>
                        <div class="knob-label">延迟时间</div>
                        <div class="knob-value">0.2s</div>
                    </div>
                    <div class="knob-item" data-param="delay-feedback" data-min="0" data-max="0.9" data-step="0.1" data-value="0.1">
                        <div class="knob-container">
                            <div class="knob"></div>
                        </div>
                        <div class="knob-label">延迟反馈</div>
                        <div class="knob-value">0.1</div>
                    </div>
                    <div class="knob-item" data-param="delay-wet" data-min="0" data-max="1" data-step="0.1" data-value="0.2">
                        <div class="knob-container">
                            <div class="knob"></div>
                        </div>
                        <div class="knob-label">延迟强度</div>
                        <div class="knob-value">0.2</div>
                    </div>
                    <div class="knob-item" data-param="reverb-decay" data-min="1" data-max="5" data-step="0.5" data-value="2">
                        <div class="knob-container">
                            <div class="knob"></div>
                        </div>
                        <div class="knob-label">混响衰减</div>
                        <div class="knob-value">2s</div>
                    </div>
                    <div class="knob-item" data-param="reverb-predelay" data-min="0" data-max="0.1" data-step="0.01" data-value="0.01">
                        <div class="knob-container">
                            <div class="knob"></div>
                        </div>
                        <div class="knob-label">混响预延迟</div>
                        <div class="knob-value">0.01s</div>
                    </div>
                    <div class="knob-item" data-param="reverb-wet" data-min="0" data-max="1" data-step="0.1" data-value="0.3">
                        <div class="knob-container">
                            <div class="knob"></div>
                        </div>
                        <div class="knob-label">混响强度</div>
                        <div class="knob-value">0.3</div>
                    </div>
                    <div class="knob-item" data-param="master-volume" data-min="0" data-max="100" data-step="1" data-value="60">
                        <div class="knob-container">
                            <div class="knob"></div>
                        </div>
                        <div class="knob-label">全局音量</div>
                        <div class="knob-value">60%</div>
                    </div>
                </div>
            </div>
        </div>
        

        

    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="js/MidiExporter.js" type="module"></script>
    <script src="js/main.js" type="module"></script>
    <script src="js/VisualManager.js" type="module"></script>
    <script>
        // 初始化Tone.js音频上下文
        document.addEventListener('click', function() {
            if (Tone.context.state !== 'running') {
                Tone.context.resume();
            }
        });
    </script>
</body>
</html>